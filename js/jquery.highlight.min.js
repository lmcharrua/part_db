(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){factory(require("jquery"))}else{factory(jQuery)}})(function(jQuery){jQuery.extend({highlight:function(node,re,nodeName,className,callback){if(node.nodeType===3){var match=node.data.match(re);if(match){var highlight=document.createElement(nodeName||"span");highlight.className=className||"highlight";var capturePos=node.data.indexOf(match[1],match.index);var wordNode=node.splitText(capturePos);wordNode.splitText(match[1].length);var wordClone=wordNode.cloneNode(true);highlight.appendChild(wordClone);wordNode.parentNode.replaceChild(highlight,wordNode);if(typeof callback=="function"){callback(highlight)}return 1}}else if(node.nodeType===1&&node.childNodes&&!/(script|style)/i.test(node.tagName)&&!(node.tagName===nodeName.toUpperCase()&&node.className===className)){for(var i=0;i<node.childNodes.length;i++){i+=jQuery.highlight(node.childNodes[i],re,nodeName,className,callback)}}return 0}});jQuery.fn.unhighlight=function(options){var settings={className:"highlight",element:"span"};jQuery.extend(settings,options);return this.find(settings.element+"."+settings.className).each(function(){var parent=this.parentNode;parent.replaceChild(this.firstChild,this);parent.normalize()}).end()};jQuery.fn.highlight=function(words,options,callback){var settings={className:"highlight",element:"span",caseSensitive:false,wordsOnly:false,wordsBoundary:"\\b"};jQuery.extend(settings,options);if(typeof words==="string"){words=[words]}words=jQuery.grep(words,function(word,i){return word!=""});words=jQuery.map(words,function(word,i){return word.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")});if(words.length===0){return this}var flag=settings.caseSensitive?"":"i";var pattern="("+words.join("|")+")";if(settings.wordsOnly){pattern=(settings.wordsBoundaryStart||settings.wordsBoundary)+pattern+(settings.wordsBoundaryEnd||settings.wordsBoundary)}var re=new RegExp(pattern,flag);return this.each(function(){jQuery.highlight(this,re,settings.element,settings.className,callback)})}});